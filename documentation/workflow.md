EulerX Toolkit Workflow
=======================

![Alt text](http://euler.cs.ucdavis.edu/_/rsrc/1366832610901/home/logo_small.png)

# Answer Set Programming (ASP) Approach Workflow

Euler/ASP toolkit implements a comprehensive and user interactive taxonomically organized datasets import, merge and visualization workflow. The workflow works based on different modules in the architecture and different modules take care of different tasks. This part we mainly focus on the workflow of Answer Set Programming Approach.

The input files (`taxonomy_alignment_problem_input`) used in Euler are plain text files, which contain the content of taxonomies and articulations. According to the format of the input files, the taxonomies are in a pair of parenthesis, start with parent concept, followed by children concepts. E.g. (parent child1 child2 child3). And the articulations are in a pair of square brackets, show the relationship between a pair of concepts which come from each taxonomy. E.g. [concept1 relation_to concept2].

The input files are needed to be checked for validity, including unmatched leaves (by convention every leaf concept should be aligned by an articulation in an alignment), children with multiple parents (usually each child concept has only one parent concept), multiple roots per taxonomy (mostly each taxonomy is a tree, so there is only one root).

After the input file is proved to be valid. The workflow will then lead to visualization for input to give the user an overview of the alignment example. The input files first go to process `input_graph_generator`, in which they are parsed into graph file in yaml format (`input_yaml_files`), showing the outline of the graph (the nodes and the connecting edges). Then the graph files are sent to our `stylesheet_processor`, which applies the styles (colors, shapes, fonts, etc) to them, and generate the visualization files in dot format that can be viewed in GraphViz (`input_gv_files`). The details of yaml files and stylesheets processor can be viewed [here][wikiStyle].

Besides for visualization, the main task for Euler is take the input files (`taxonomy_alignment_problem_input`) for alignment. In order to do this, some parameters need to be addressed for Euler, including some taxonomic constraints and an encoding method (`encoding_type`). Taxonomic constraints include coverage (parent concepts covers the union of the children concepts) and sibling-disjointness (sibling concepts are mutually exclusive), they are enabled by default, but can be turned off by user. Encoding methods include mnpw (polynomial encoding for possible worlds), mncb (polynomial encoding for combined concepts), vrpw (binary encoding for possible worlds), vrve (binary encoding for valid regions). This process `encoder` takes the input files, extract the constraints of relationships (such as ISA in taxonomies, RCC relations in ambiguous/unambiguous articulations, and coverage and sibling-disjointness). Then translates these constraints into `asp_files` which contain disjunctive datalog-like facts and rules, representing all constraints information for a particular alignment example. Then a particular ASP `reasoner` (DLV or Gringo) is suggested by user for reasoning this alignment in process `asp_reasoner`. The ASP reasoners are artificial intelligence system based on disjunctive logic programming to solve ASP reasoning problem.

There are two scenarios after the reasoning process. If the ASP reasoners returns no results, which means there is no possible worlds generated, this alignment is inconsistent (`no_possible_worlds`), or else there are answer sets generated, which turns this alignment is consistent (`possible worlds`). 

In the case of inconsistent example, Euler will generate a diagnostic lattice to explain the inconsistency. First Euler will calculate all Minimal Inconsistent Subsets (`mis_generator`). MIS (Minimal Inconsistent Subsets) are the minimal subsets of articulations to make the example inconsistent, any of its supersets is inconsistent. On the other hand, we have MCS (Maximal Consistent Subsets), showing the maximal subsets of articulations to make the example consistent, any of its subsets is consistent. Then Euler takes MIS and MCS to generate a pair of powerset lattices with all combinations of articulations (lattice_generator), including full-lattice (show all power sets of combinations of articulations) and reduced-lattice (show all MIS and MCS, merge all other consistent nodes into a single green node, merge all other inconsistent node into a single red node).

In the case of consistent example, the reasoner outputs answer sets (models of the constraints of this example), Euler will render them to `possible_worlds`, which is in the format of non-disjunctive relationships between any pair of concepts. With the possible worlds, Euler generates Most Informative Relations (MIR) through `mir_generator`. MIR is in csv format, showing the relationships (maybe ambiguous) between each pair of concepts.  As for visualization of possible worlds, it is similar to visualization process of input files. The possible worlds are first generated as yaml files in `pw_graph_generator`, then they are sent to `stylesheet_processor` to generate dot files that can be viewed in GraphViz. Euler will also take possible worlds to generate summary view of visualizations, including aggregate view (combine the visualization of all possible worlds, showing every nodes in each possible worlds, and the weights of edges are the frequency of appearance for corresponding relationships in all worlds), cluster view (each possible world is represented by a node, and the weights of edges are the number of different relationships between the corresponding worlds), hierarchy view (shrink each cycle in aggregate view into single “merged” node, showing the hierarchical structure of all possible worlds). All the graph files in summary view will be taken to stylesheet processor to generate dot files.


# Region Connection Calculus (RCC) Approach Workflow
The RCC workflow is much similar to ASP approach workflow. There is a little difference in reasoning process. A `rcc_parser` takes `taxonomy_alignment_problem_input`, translates the constraints in input file to a matrix showing all pairwise relations, which we called it “Uber-MIR” matrix, in which all relations are initialized: if this pair of concepts appears in input (ISA, or articulations), their relationships are initialized as input shows; if this pair of relation is not initialized in input, use a placeholder as all B5 relations ({!, <, >, o, =}). The `rcc_reasoner` reasons in Uber-MIR matrix to refine all relations (to reduce ambiguities in each relations until nothing changes to get MIR) or output inconsistency. Then a `possible_worlds_generator` is used to generate possible worlds from `mir_files`, so it is actually reverse comparing to ASP approaches. The other process like visualizations are same as ASP approaches.

[wikiStyle]: https://github.com/EulerProject/EulerX/wiki/Stylesheet-Processor
